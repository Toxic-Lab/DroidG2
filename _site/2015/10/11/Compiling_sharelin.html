<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="author" content="Toxic-lab (HK)" />
    <title>Droid-G2 development guide 2/3</title>

    <link rel="stylesheet" href="/stylesheets/styles.css">
    <link rel="stylesheet" href="/stylesheets/pygment_trac.css">
    <script src="/javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Droid G2 - Gnutella 2 client on Android</h1>
        <p class="header">Droid G2 - Gnutella 2 client on Android</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/Toxic-Lab/DroidG2/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/Toxic-Lab/DroidG2/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/Toxic-Lab/DroidG2">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/Toxic-Lab">Toxic-Lab</a></p>
      </header>

      <section>
      <div class="post">
    
  </header>
    
  <h1>Droid-G2 development guide 2/3</h1>
  <p class="meta">Oct 11, 2015</p>

  <article class="post-content">
  <p>Welcome to the second step of compiling the Droid-G2.</p>

<p>The goal of this step is to compile the Sharelin library, link all the boost library object files, and create a single file called libsharelin.so.</p>

<ul>
  <li>Download the source of sharelin from the sourceforge. <a href="http://sourceforge.net/projects/sharelin/">http://sourceforge.net/projects/sharelin/</a></li>
  <li>Check that CrystalX NDK is in-place.</li>
  <li>Copy the boost static library files and header file to a subfolder under project directory (In this project, it is copied to /boost/lib and /boost/include respectively).</li>
  <li>Create the Android.MK file. <a href="https://github.com/Toxic-Lab/DroidG2/blob/master/sharelin-core/jni/Android.mk">https://github.com/Toxic-Lab/DroidG2/blob/master/sharelin-core/jni/Android.mk</a></li>
  <li>Compile the code using CrystalX Android NDK first. You will discovered some compilation error because of missing CONSTANT and functions in Android Linux header.
    <ul>
      <li>These errors can be fixed by simply defining the CONSTANT and use the overload methods of the missing function.</li>
    </ul>
  </li>
  <li>You also needed to define JNI interface for interact with your Android application.
    <ul>
      <li>Define the java interface </li>
      <li>Follow the JNI tutorial to generate the .hpp file <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/javah.html">http://docs.oracle.com/javase/7/docs/technotes/tools/solaris/javah.html</a></li>
      <li>Create .cpp file and implement the function in the header file</li>
      <li>Example: 
        <ul>
          <li>sl.cpp: <a href="https://github.com/Toxic-Lab/DroidG2/blob/master/sharelin-core/jni/src/sl.cpp">https://github.com/Toxic-Lab/DroidG2/blob/master/sharelin-core/jni/src/sl.cpp</a></li>
          <li>sl.hpp: <a href="https://github.com/Toxic-Lab/DroidG2/blob/master/sharelin-core/jni/src/sl.hpp">https://github.com/Toxic-Lab/DroidG2/blob/master/sharelin-core/jni/src/sl.hpp</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Use make to compile the project</li>
  <li>Now we have the libsharelin.so file and have native C functions talking with Java JVM.</li>
</ul>

<p>In the next post, we are going to present how to compile the Droid-G2 android application.</p>

  </article>

</div>

      </section>

      <footer>
      <p><small>Hosted on <a href="http://pages.github.com/">GitHub Pages</a> using the Dinky theme
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>
